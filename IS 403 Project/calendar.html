<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar - Cal-Endure to the End</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="app-page">
    <!-- Top Navigation -->
    <nav class="app-navbar">
        <div class="app-nav-container">
            <div class="app-nav-brand">
                <h1>Cal-Endure to the End</h1>
            </div>
            <div class="app-nav-links">
                <a href="dashboard.html" class="nav-link">
                    <span class="nav-icon">üéØ</span>
                    <span>Goals</span>
                </a>
                <a href="calendar.html" class="nav-link active">
                    <span class="nav-icon">üìÖ</span>
                    <span>Calendar</span>
                </a>
                <a href="contacts.html" class="nav-link">
                    <span class="nav-icon">üë•</span>
                    <span>Contacts</span>
                </a>
            </div>
            <div class="app-nav-user">
                <div class="user-menu">
                    <img src="https://via.placeholder.com/40" alt="User" class="user-avatar">
                    <span class="user-name">Elder Smith</span>
                    <div class="user-dropdown">
                        <a href="#profile">Profile</a>
                        <a href="#settings">Settings</a>
                        <a href="login.html">Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="app-main">
        <div class="app-container">
            <!-- Page Header -->
            <header class="page-header">
                <div>
                    <h1 class="page-title">Calendar</h1>
                    <p class="page-subtitle">Plan every hour of your day</p>
                </div>
                <div class="header-actions">
                    <button class="btn-secondary" onclick="goToToday()">Today</button>
                    <button class="btn-primary" onclick="openAddEventModal()">
                        <span>+ Add Event</span>
                    </button>
                </div>
            </header>

            <!-- Calendar Controls -->
            <div class="calendar-controls">
                <div class="calendar-nav">
                    <button class="btn-icon" onclick="previousMonth()">‚óÄ</button>
                    <h2 id="current-month">February 2025</h2>
                    <button class="btn-icon" onclick="nextMonth()">‚ñ∂</button>
                </div>
                <div class="calendar-view-toggle">
                    <button class="view-btn active" data-view="month">Month</button>
                    <button class="view-btn" data-view="week">Week</button>
                    <button class="view-btn" data-view="day">Day</button>
                </div>
            </div>

            <!-- Calendar Grid -->
            <div class="calendar-container">
                <div class="calendar-weekdays">
                    <div class="weekday">Sunday</div>
                    <div class="weekday">Monday</div>
                    <div class="weekday">Tuesday</div>
                    <div class="weekday">Wednesday</div>
                    <div class="weekday">Thursday</div>
                    <div class="weekday">Friday</div>
                    <div class="weekday">Saturday</div>
                </div>
                <div class="calendar-days" id="calendar-days">
                    <!-- Days will be generated by JavaScript -->
                </div>
            </div>

            <!-- Today's Schedule -->
            <div class="todays-schedule">
                <h3>Today's Schedule</h3>
                <div class="schedule-list" id="todays-events">
                    <div class="schedule-event spiritual" draggable="true" ondragstart="dragEvent(event)" data-event-id="1">
                        <div class="event-time-badge">9:00 AM</div>
                        <div class="event-details">
                            <div class="event-title">Scripture Study</div>
                            <div class="event-meta">
                                <span class="event-type">‚úùÔ∏è Spiritual</span>
                                <span class="event-contact">Personal</span>
                            </div>
                        </div>
                        <div class="event-actions">
                            <button class="btn-icon-small" onclick="editEvent(1)">‚úèÔ∏è</button>
                            <button class="btn-icon-small" onclick="deleteEvent(1)">üóëÔ∏è</button>
                        </div>
                    </div>

                    <div class="schedule-event social" draggable="true" ondragstart="dragEvent(event)" data-event-id="2">
                        <div class="event-time-badge">2:00 PM</div>
                        <div class="event-details">
                            <div class="event-title">Lunch with Sarah</div>
                            <div class="event-meta">
                                <span class="event-type">üë• Social</span>
                                <span class="event-contact">Sarah Johnson</span>
                            </div>
                        </div>
                        <div class="event-actions">
                            <button class="btn-icon-small" onclick="editEvent(2)">‚úèÔ∏è</button>
                            <button class="btn-icon-small" onclick="deleteEvent(2)">üóëÔ∏è</button>
                        </div>
                    </div>

                    <div class="schedule-event physical" draggable="true" ondragstart="dragEvent(event)" data-event-id="3">
                        <div class="event-time-badge">6:00 PM</div>
                        <div class="event-details">
                            <div class="event-title">Gym Workout</div>
                            <div class="event-meta">
                                <span class="event-type">üí™ Physical</span>
                                <span class="event-contact">Personal</span>
                            </div>
                        </div>
                        <div class="event-actions">
                            <button class="btn-icon-small" onclick="editEvent(3)">‚úèÔ∏è</button>
                            <button class="btn-icon-small" onclick="deleteEvent(3)">üóëÔ∏è</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Add/Edit Event Modal -->
    <div id="event-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 id="event-modal-title">Add New Event</h2>
                <button class="modal-close" onclick="closeEventModal()">&times;</button>
            </div>
            <form id="event-form" class="modal-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="event-title">Event Title</label>
                        <input type="text" id="event-title" name="title" placeholder="What's happening?" required>
                    </div>
                    <div class="form-group">
                        <label for="event-category">Goal Category</label>
                        <select id="event-category" name="category" required>
                            <option value="">Select category...</option>
                            <option value="spiritual">‚úùÔ∏è Spiritual</option>
                            <option value="social">üë• Social</option>
                            <option value="intellectual">üìö Intellectual</option>
                            <option value="physical">üí™ Physical</option>
                            <option value="romantic">‚ù§Ô∏è Romantic</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="event-date">Date</label>
                        <input type="date" id="event-date" name="date" required>
                    </div>
                    <div class="form-group">
                        <label for="event-start-time">Start Time</label>
                        <input type="time" id="event-start-time" name="startTime" required>
                    </div>
                    <div class="form-group">
                        <label for="event-end-time">End Time</label>
                        <input type="time" id="event-end-time" name="endTime">
                    </div>
                </div>

                <div class="form-group">
                    <label for="event-location">Location (Optional)</label>
                    <input type="text" id="event-location" name="location" placeholder="Where is this happening?">
                </div>

                <div class="form-group">
                    <label for="event-contacts">Attach Contacts</label>
                    <select id="event-contacts" name="contacts" multiple class="multi-select">
                        <option value="1">Sarah Johnson</option>
                        <option value="2">John Smith</option>
                        <option value="3">Emily Davis</option>
                        <option value="4">Michael Brown</option>
                        <option value="5">Sister Martinez</option>
                    </select>
                    <small class="form-hint">Hold Ctrl/Cmd to select multiple contacts</small>
                </div>

                <div class="form-group">
                    <label for="event-notes">Notes (Optional)</label>
                    <textarea id="event-notes" name="notes" rows="3" placeholder="Add any additional details..."></textarea>
                </div>

                <div class="form-group">
                    <label class="checkbox-container">
                        <input type="checkbox" name="reminder" id="event-reminder">
                        <span>Send me a reminder</span>
                    </label>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn-outline" onclick="closeEventModal()">Cancel</button>
                    <button type="submit" class="btn-primary">Save Event</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Calendar state
        let currentDate = new Date();
        let selectedDate = new Date();

        // Generate calendar
        function generateCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();

            // Update header
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                'July', 'August', 'September', 'October', 'November', 'December'];
            document.getElementById('current-month').textContent = `${monthNames[month]} ${year}`;

            // Get first day of month and number of days
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const daysInPrevMonth = new Date(year, month, 0).getDate();

            const calendarDays = document.getElementById('calendar-days');
            calendarDays.innerHTML = '';

            // Previous month days
            for (let i = firstDay - 1; i >= 0; i--) {
                const day = daysInPrevMonth - i;
                const dayDiv = createDayCell(day, 'other-month');
                calendarDays.appendChild(dayDiv);
            }

            // Current month days
            for (let day = 1; day <= daysInMonth; day++) {
                const isToday = day === new Date().getDate() &&
                               month === new Date().getMonth() &&
                               year === new Date().getFullYear();
                const dayDiv = createDayCell(day, isToday ? 'today' : 'current-month');
                calendarDays.appendChild(dayDiv);
            }

            // Next month days
            const totalCells = calendarDays.children.length;
            const remainingCells = 42 - totalCells; // 6 rows √ó 7 days
            for (let day = 1; day <= remainingCells; day++) {
                const dayDiv = createDayCell(day, 'other-month');
                calendarDays.appendChild(dayDiv);
            }
        }

        function createDayCell(day, className) {
            const dayDiv = document.createElement('div');
            dayDiv.className = `calendar-day ${className}`;
            dayDiv.innerHTML = `
                <div class="day-number">${day}</div>
                <div class="day-events" ondrop="dropEvent(event)" ondragover="allowDrop(event)">
                    ${className === 'today' ? getSampleEvents() : ''}
                </div>
            `;
            dayDiv.addEventListener('click', () => showDayEvents(day));
            return dayDiv;
        }

        function getSampleEvents() {
            return `
                <div class="mini-event spiritual">Scripture Study</div>
                <div class="mini-event social">Lunch</div>
                <div class="mini-event physical">Workout</div>
            `;
        }

        function previousMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            generateCalendar();
        }

        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            generateCalendar();
        }

        function goToToday() {
            currentDate = new Date();
            generateCalendar();
        }

        function showDayEvents(day) {
            console.log('Show events for day:', day);
            // In real implementation, filter and display events for this day
        }

        // Drag and drop
        let draggedEventId = null;

        function dragEvent(e) {
            draggedEventId = e.target.dataset.eventId;
            e.target.style.opacity = '0.5';
        }

        function allowDrop(e) {
            e.preventDefault();
            e.currentTarget.style.backgroundColor = 'rgba(46, 192, 249, 0.1)';
        }

        function dropEvent(e) {
            e.preventDefault();
            e.currentTarget.style.backgroundColor = '';
            if (draggedEventId) {
                console.log('Moving event', draggedEventId, 'to', e.currentTarget.closest('.calendar-day'));
                // In real implementation, update event date in database
                draggedEventId = null;
            }
        }

        document.addEventListener('dragend', (e) => {
            if (e.target.classList.contains('schedule-event')) {
                e.target.style.opacity = '1';
            }
        });

        document.addEventListener('dragleave', (e) => {
            if (e.target.classList.contains('day-events')) {
                e.target.style.backgroundColor = '';
            }
        });

        // Event modal functions
        function openAddEventModal() {
            document.getElementById('event-modal').style.display = 'flex';
            document.getElementById('event-modal-title').textContent = 'Add New Event';
            document.getElementById('event-form').reset();
            // Set today as default date
            document.getElementById('event-date').valueAsDate = new Date();
        }

        function closeEventModal() {
            document.getElementById('event-modal').style.display = 'none';
        }

        function editEvent(eventId) {
            openAddEventModal();
            document.getElementById('event-modal-title').textContent = 'Edit Event';
            // In real implementation, load event data
            console.log('Editing event:', eventId);
        }

        function deleteEvent(eventId) {
            if (confirm('Are you sure you want to delete this event?')) {
                console.log('Deleting event:', eventId);
                // In real implementation, delete from database and remove from DOM
            }
        }

        // Form submission
        document.getElementById('event-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            console.log('Saving event:', Object.fromEntries(formData));
            // In real implementation, save to database
            closeEventModal();
            alert('Event saved successfully!');
        });

        // View toggle
        document.querySelectorAll('.view-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                const view = this.dataset.view;
                console.log('Switching to view:', view);
                // In real implementation, change calendar view
            });
        });

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('event-modal');
            if (event.target === modal) {
                closeEventModal();
            }
        }

        // User dropdown toggle
        document.querySelector('.user-menu').addEventListener('click', function(e) {
            this.querySelector('.user-dropdown').classList.toggle('show');
        });

        document.addEventListener('click', function(e) {
            if (!e.target.closest('.user-menu')) {
                document.querySelectorAll('.user-dropdown').forEach(dropdown => {
                    dropdown.classList.remove('show');
                });
            }
        });

        // Initialize calendar on page load
        generateCalendar();
    </script>
</body>
</html>
