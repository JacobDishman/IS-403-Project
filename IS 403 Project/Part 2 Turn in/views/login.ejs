<%- include('partials/header', {pageTitle: 'Login - Cal-Endure to the End'}) %>
<body class="auth-page">
    <!-- Simple Navigation -->
    <nav class="navbar-simple">
        <div class="container">
            <a href="/" class="nav-brand-simple">
                <h1>Cal-Endure to the End</h1>
            </a>
        </div>
    </nav>

    <!-- Auth Container -->
    <div class="auth-container">
        <div class="auth-box">
            <!-- Login Form -->
            <div id="login-form" class="form-section">
                <div class="form-header">
                    <h2>Welcome Back</h2>
                    <p>Continue your journey of organization and discipline</p>
                </div>

                <% if (typeof error !== 'undefined') { %>
                    <div class="alert alert-error"><%= error %></div>
                <% } %>

                <form class="auth-form" action="/login" method="POST">
                    <div class="form-group">
                        <label for="login-email">Email Address</label>
                        <input
                            type="email"
                            id="login-email"
                            name="email"
                            placeholder="your.email@example.com"
                            required
                        >
                    </div>

                    <div class="form-group">
                        <label for="login-password">Password</label>
                        <input
                            type="password"
                            id="login-password"
                            name="password"
                            placeholder="Enter your password"
                            required
                        >
                    </div>

                    <div class="form-options">
                        <label class="checkbox-container">
                            <input type="checkbox" name="remember" id="remember-me">
                            <span>Remember me</span>
                        </label>
                        <a href="#" class="link-primary">Forgot password?</a>
                    </div>

                    <button type="submit" class="btn-primary btn-full">Login</button>
                </form>

                <div class="form-footer">
                    <p>Don't have an account? <a href="#signup" class="link-primary" onclick="showSignup()">Sign up here</a></p>
                </div>
            </div>

            <!-- Signup Form -->
            <div id="signup-form" class="form-section" style="display: none;">
                <div class="form-header">
                    <h2>Create Your Account</h2>
                    <p>Start organizing your life the missionary way</p>
                </div>

                <% if (typeof signupError !== 'undefined') { %>
                    <div class="alert alert-error"><%= signupError %></div>
                <% } %>

                <form class="auth-form" action="/signup" method="POST">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="signup-firstname">First Name</label>
                            <input
                                type="text"
                                id="signup-firstname"
                                name="firstname"
                                placeholder="John"
                                required
                            >
                        </div>

                        <div class="form-group">
                            <label for="signup-lastname">Last Name</label>
                            <input
                                type="text"
                                id="signup-lastname"
                                name="lastname"
                                placeholder="Smith"
                                required
                            >
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="signup-email">Email Address</label>
                        <input
                            type="email"
                            id="signup-email"
                            name="email"
                            placeholder="your.email@example.com"
                            required
                        >
                    </div>

                    <div class="form-group">
                        <label for="signup-username">Username</label>
                        <input
                            type="text"
                            id="signup-username"
                            name="username"
                            placeholder="Choose a username"
                            required
                        >
                    </div>

                    <div class="form-group">
                        <label for="signup-password">Password</label>
                        <input
                            type="password"
                            id="signup-password"
                            name="password"
                            placeholder="Create a strong password"
                            required
                        >
                        <small class="form-hint">Must be at least 8 characters</small>
                    </div>

                    <div class="form-group">
                        <label for="signup-confirm-password">Confirm Password</label>
                        <input
                            type="password"
                            id="signup-confirm-password"
                            name="confirmPassword"
                            placeholder="Re-enter your password"
                            required
                        >
                    </div>

                    <div class="form-group">
                        <label for="mission-field">Mission (Optional)</label>
                        <input
                            type="text"
                            id="mission-field"
                            name="mission"
                            placeholder="e.g., California San Jose Mission"
                        >
                        <small class="form-hint">Share where you served!</small>
                    </div>

                    <div class="form-options">
                        <label class="checkbox-container">
                            <input type="checkbox" name="terms" id="terms-agree" required>
                            <span>I agree to the Terms of Service and Privacy Policy</span>
                        </label>
                    </div>

                    <button type="submit" class="btn-primary btn-full">Create Account</button>
                </form>

                <div class="form-footer">
                    <p>Already have an account? <a href="#login" class="link-primary" onclick="showLogin()">Login here</a></p>
                </div>
            </div>
        </div>

        <!-- Side Panel with Info -->
        <div class="auth-side-panel">
            <div class="side-panel-content">
                <h3>Stay Organized, Stay Focused</h3>
                <ul class="benefits-list">
                    <li>
                        <span class="benefit-icon">✓</span>
                        <span>Plan every hour like you're still on the mission</span>
                    </li>
                    <li>
                        <span class="benefit-icon">✓</span>
                        <span>Manage contacts with photos and history</span>
                    </li>
                    <li>
                        <span class="benefit-icon">✓</span>
                        <span>Track events and maintain relationships</span>
                    </li>
                    <li>
                        <span class="benefit-icon">✓</span>
                        <span>Sync across all your devices</span>
                    </li>
                </ul>
                <div class="testimonial">
                    <p class="testimonial-text">"Finally, a calendar that matches the organization I had as a missionary. CEE helps me stay disciplined!"</p>
                    <p class="testimonial-author">- Elder Johnson, RM</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Toggle between login and signup forms
        function showSignup() {
            document.getElementById('login-form').style.display = 'none';
            document.getElementById('signup-form').style.display = 'block';
        }

        function showLogin() {
            document.getElementById('signup-form').style.display = 'none';
            document.getElementById('login-form').style.display = 'block';
        }

        // Check URL hash on page load
        window.addEventListener('DOMContentLoaded', () => {
            if (window.location.hash === '#signup') {
                showSignup();
            }
        });

        // Handle hash changes
        window.addEventListener('hashchange', () => {
            if (window.location.hash === '#signup') {
                showSignup();
            } else {
                showLogin();
            }
        });

        // Simple password confirmation validation
        const signupForm = document.querySelector('#signup-form form');
        if (signupForm) {
            signupForm.addEventListener('submit', (e) => {
                const password = document.getElementById('signup-password').value;
                const confirmPassword = document.getElementById('signup-confirm-password').value;

                if (password !== confirmPassword) {
                    e.preventDefault();
                    alert('Passwords do not match!');
                }
            });
        }
    </script>
</body>
</html>
